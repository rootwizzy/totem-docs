<!DOCTYPE html><html lang="en"><head><title>thinkspace-indented-list/addon/mixins/item/component</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../"><meta name="groc-document-path" content="thinkspace-indented-list/addon/mixins/item/component"><meta name="groc-project-path" content="thinkspace-indented-list/addon/mixins/item/component.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../../../assets/style.css"><script type="text/javascript" src="../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">thinkspace-indented-list/addon/mixins/item/component.coffee</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper">import ember  from <span class="hljs-string">'ember'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="methods-called-by-a-component-">Methods called by a component. ###</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">export default ember.Mixin.create

  <span class="hljs-attribute">get_item_value</span>: <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> ember.RSVP.Promise (resolve, reject) =&gt;
      description = item.description
      <span class="hljs-keyword">return</span> resolve(description)  <span class="hljs-keyword">if</span> ember.isPresent(description)
      <span class="hljs-property">@get_item_itemable</span>(item).<span class="hljs-keyword">then</span> (itemable) =&gt;
        value_path = item.itemable_value_path
        <span class="hljs-keyword">if</span> ember.isBlank(itemable) <span class="hljs-keyword">or</span> ember.isBlank(value_path)
          resolve item.description <span class="hljs-keyword">or</span> <span class="hljs-property">@default_item_description</span>()
        <span class="hljs-keyword">else</span>
          resolve itemable.get(value_path)

  <span class="hljs-attribute">set_all_items_visibility</span>: <span class="hljs-function"><span class="hljs-params">(visible)</span> -&gt;</span> <span class="hljs-property">@set_children_items_visibility</span>(<span class="hljs-property">@value_items</span>, visible)

  <span class="hljs-attribute">set_children_items_visibility</span>: <span class="hljs-function"><span class="hljs-params">(items, visible)</span> -&gt;</span>
    min_x = <span class="hljs-property">@get_minimum_pos_x</span>()

    items.forEach (item) =&gt;
      comp = <span class="hljs-property">@get_item_component</span>(item)
      comp.set <span class="hljs-string">'item_visible'</span>, visible  <span class="hljs-keyword">unless</span> item.pos_x == min_x
      <span class="hljs-keyword">if</span> comp.get(<span class="hljs-string">'has_children'</span>)
        comp.set <span class="hljs-string">'children_visible'</span>, visible
        </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set number of children aftwerwards to ensure the count is correct when packing all.</p></div></div><div class="code"><div class="wrapper">    items.forEach (item) =&gt;
      comp = <span class="hljs-property">@get_item_component</span>(item)
      comp.set_number_of_children()

  <span class="hljs-attribute">show_confirm_remove</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-property">@confirm_remove</span>

  <span class="hljs-attribute">calc_item_indent</span>: <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span> (item.pos_x <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>) * <span class="hljs-property">@indent_px</span>

  <span class="hljs-attribute">add_element_item_classes</span>: <span class="hljs-function"><span class="hljs-params">($el, item)</span> -&gt;</span>
    class_names = item.class_names
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> ember.isBlank(class_names)
    $el.addClass ember.makeArray(class_names).join(<span class="hljs-string">' '</span>)

  <span class="hljs-attribute">add_draggable_class</span>:    <span class="hljs-function"><span class="hljs-params">($el)</span> -&gt;</span> $el.addClass(<span class="hljs-property">@draggable_class</span>)
  <span class="hljs-attribute">remove_draggable_class</span>: <span class="hljs-function"><span class="hljs-params">($el)</span> -&gt;</span> $el.removeClass(<span class="hljs-property">@draggable_class</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="called-after-an-item-edit-action-">Called after an item edit action. #</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">clear_item_itemable</span>: <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> ember.RSVP.Promise (resolve, reject) =&gt;
      <span class="hljs-keyword">return</span> resolve()  <span class="hljs-keyword">if</span> ( ember.isBlank(item.itemable_id) <span class="hljs-keyword">and</span> ember.isBlank(item.itemable_type) <span class="hljs-keyword">and</span> ember.isBlank(item.itemable_value_path) )
      oitem = ember.merge({}, item)  <span class="hljs-comment"># copy the original item with the itemable values for 'is_used'</span>
      <span class="hljs-keyword">delete</span>(item.itemable_id)
      <span class="hljs-keyword">delete</span>(item.itemable_type)
      <span class="hljs-keyword">delete</span>(item.itemable_value_path)
      <span class="hljs-property">@clear_itemable_is_used_unless_used_by_another_item</span>(oitem).<span class="hljs-keyword">then</span> =&gt;
        resolve()
        <span class="hljs-property">@save_response</span>()</div></div></div></div></body></html>