<!DOCTYPE html><html lang="en"><head><title>thinkspace-indented-list/addon/mixins/helpers</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="thinkspace-indented-list/addon/mixins/helpers"><meta name="groc-project-path" content="thinkspace-indented-list/addon/mixins/helpers.coffee"><meta name="groc-github-url" content="https://github.com/sixthedge/ethinkspace-client"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/sixthedge/ethinkspace-client/blob/master/thinkspace-indented-list/addon/mixins/helpers.coffee">thinkspace-indented-list/addon/mixins/helpers.coffee</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper">import ember          from <span class="hljs-string">'ember'</span>
import totem_error    from <span class="hljs-string">'totem/error'</span>

export default ember.Mixin.create

  <span class="hljs-attribute">get_element_item</span>:      <span class="hljs-function"><span class="hljs-params">($el)</span> -&gt;</span> <span class="hljs-property">@get_element_component</span>($el).get(<span class="hljs-string">'item'</span>)
  <span class="hljs-attribute">get_element_component</span>: <span class="hljs-function"><span class="hljs-params">($el)</span> -&gt;</span> <span class="hljs-property">@el_id_to_component</span>.get($el.attr <span class="hljs-string">'id'</span>)

  <span class="hljs-attribute">get_item_component</span>: <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span> <span class="hljs-property">@item_to_component</span>.get(item)
  <span class="hljs-attribute">get_item_element</span>:   <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span>
    comp = <span class="hljs-property">@get_item_component</span>(item)
    comp <span class="hljs-keyword">and</span> comp.$()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If the sibling is the list end class, ignore it.
An empty div at the end of the list is needed to avoid the issue where Ember loses track of the DOM fragment
picked up by Dragula.  This could be replicated by changing the pos_x of the last item, then trying to place an item below it.
This would not render correctly as Ember seemingly loses track of the original DOM fragment.  The value_items was always correctly in sync.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">get_sibling</span>: <span class="hljs-function"><span class="hljs-params">(sibling)</span> -&gt;</span>
    $sibling = $(sibling)
    <span class="hljs-keyword">if</span> $sibling.hasClass(<span class="hljs-property">@default_list_end_class</span>()) <span class="hljs-keyword">then</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">else</span> sibling

  <span class="hljs-attribute">get_minimum_pos_x</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-property">@value_items</span>.mapBy(<span class="hljs-string">'pos_x'</span>).sort().shift() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>

  <span class="hljs-attribute">set_item_pos_x</span>: <span class="hljs-function"><span class="hljs-params">(item, pos_x)</span> -&gt;</span> ember.set(item, <span class="hljs-string">'pos_x'</span>, pos_x)
  <span class="hljs-attribute">set_item_pos_y</span>: <span class="hljs-function"><span class="hljs-params">(item, pos_y)</span> -&gt;</span> ember.set(item, <span class="hljs-string">'pos_y'</span>, pos_y)
  <span class="hljs-attribute">set_items_pos_y</span>: <span class="hljs-function"><span class="hljs-params">(items)</span>      -&gt;</span> items.forEach (item, index) =&gt; <span class="hljs-property">@set_item_pos_y</span>(item, index)

  <span class="hljs-attribute">is_jquery_object</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span> obj <span class="hljs-keyword">and</span> jQuery <span class="hljs-keyword">and</span> (obj <span class="hljs-keyword">instanceof</span>(jQuery))

  <span class="hljs-attribute">is_function</span>: <span class="hljs-function"><span class="hljs-params">(fn)</span> -&gt;</span> <span class="hljs-keyword">typeof</span>(fn) == <span class="hljs-string">'function'</span>

  <span class="hljs-attribute">is_object</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span> obj <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span>(obj) == <span class="hljs-string">'object'</span>

  <span class="hljs-attribute">is_hash</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span> <span class="hljs-property">@is_object</span>(obj) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> ember.isArray(obj)

  <span class="hljs-attribute">debug_items</span>: <span class="hljs-function"><span class="hljs-params">(items)</span> -&gt;</span>
    msg = []
    msg.push <span class="hljs-string">"Items:<span class="hljs-subst">#{items.length}</span> -&gt;"</span>
    items.map (item) =&gt; msg.push <span class="hljs-string">"[y:<span class="hljs-subst">#{item.pos_y}</span> id:<span class="hljs-subst">#{item.itemable_id}</span>]"</span>
    <span class="hljs-built_in">console</span>.info msg.join(<span class="hljs-string">', '</span>)

  <span class="hljs-attribute">stringify</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span> JSON.stringify(obj)

  <span class="hljs-attribute">error</span>: <span class="hljs-function"><span class="hljs-params">(message=<span class="hljs-string">''</span>)</span> -&gt;</span> totem_error.<span class="hljs-keyword">throw</span> @, message

  <span class="hljs-attribute">toString</span>: <span class="hljs-function">-&gt;</span> <span class="hljs-string">'ResponseManager'</span></div></div></div></div></body></html>