<!DOCTYPE html><html lang="en"><head><title>totem/client/totem/addon/error</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../"><meta name="groc-document-path" content="totem/client/totem/addon/error"><meta name="groc-project-path" content="src/totem/client/totem/addon/error.coffee"><meta name="groc-branch-path" content="feature/pe-documentation"><meta name="groc-github-url" content="https://github.com/sixthedge/cellar"><link rel="stylesheet" type="text/css" media="all" href="../../../../assets/style.css"><script type="text/javascript" src="../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/sixthedge/cellar/blob/feature/pe-documentation/src/totem/client/totem/addon/error.coffee">src/totem/client/totem/addon/error.coffee</a></div></div><div id="document"><a href="/" class="lodestar-link">Back to Guides</a><div class="segment"><div class="code"><div class="wrapper">import ember from <span class="hljs-string">'ember'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TotemError</span></span>
  <span class="hljs-attribute">toString</span>:    <span class="hljs-function">-&gt;</span> <span class="hljs-string">'totem_error'</span>

  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(options={})</span> -&gt;</span>
    <span class="hljs-property">@is_totem_error</span> = <span class="hljs-literal">true</span>
    <span class="hljs-property">@is_handled</span>     = <span class="hljs-literal">false</span>
    <span class="hljs-property">@is_api_error</span>   = options.api <span class="hljs-keyword">or</span> <span class="hljs-literal">false</span>
    <span class="hljs-property">@stack</span>          = options.stack
    <span class="hljs-property">@message</span>        = options.message</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Allow routes and controllers to call: @totem_error.throw(@, message, options).
When the source (e.g. @) is passed and has a toString function, will prefix
the error message with the toString value.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">throw</span>: <span class="hljs-function"><span class="hljs-params">(source=<span class="hljs-literal">null</span>, message=<span class="hljs-literal">null</span>, options=<span class="hljs-literal">null</span>)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span>(source) == <span class="hljs-string">'string'</span>  <span class="hljs-comment"># did not pass a source object, so shift arguments</span>
      options = message
      message = source
      source  = <span class="hljs-literal">null</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Generate message from arguments.</p></div></div><div class="code"><div class="wrapper">    message ?= <span class="hljs-string">''</span>
    message  = <span class="hljs-string">"<span class="hljs-subst">#{source.toString()}</span>: <span class="hljs-subst">#{message}</span>"</span> <span class="hljs-keyword">if</span> source <span class="hljs-keyword">and</span> source.toString
    message += <span class="hljs-string">"[<span class="hljs-subst">#{JSON.stringify(options)}</span>] "</span>    <span class="hljs-keyword">if</span> options
    options = {}  <span class="hljs-keyword">unless</span> options <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span>(options) == <span class="hljs-string">'object'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get stack track and throw error.</p></div></div><div class="code"><div class="wrapper">    ember_error     = <span class="hljs-keyword">new</span> ember.Error()
    options.message = message
    options.stack   = ember_error.stack</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If the ember application is not ready (e.g. an error raised in an initializer)
throw a javascript Error instead of a TotemError.  Otherwise get &#39;uncaught exception: totem_error&#39;.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> ember.onerror
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> TotemError(options)
    <span class="hljs-keyword">else</span>
      message += <span class="hljs-string">"\n<span class="hljs-subst">#{options.stack}</span>"</span>  <span class="hljs-keyword">if</span> options.stack
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error message</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Class method so if &quot;import from &#39;totem/error&#39;&quot; can call totem_error.throw(@, message, options).</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@throw</span>: <span class="hljs-function"><span class="hljs-params">(source=<span class="hljs-literal">null</span>, message=<span class="hljs-literal">null</span>, options=<span class="hljs-literal">null</span>)</span> -&gt;</span> totem_error.<span class="hljs-keyword">throw</span>(source, message, options)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Create single instance for the @throw class method.</p></div></div><div class="code"><div class="wrapper">totem_error = <span class="hljs-keyword">new</span> TotemError

export default TotemError</div></div></div></div></body></html>