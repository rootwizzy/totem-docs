<!DOCTYPE html><html lang="en"><head><title>thinkspace/client/thinkspace-peer-assessment-pe/addon/components/assessment/item/quantitative</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../../../../"><meta name="groc-document-path" content="thinkspace/client/thinkspace-peer-assessment-pe/addon/components/assessment/item/quantitative"><meta name="groc-project-path" content="src/thinkspace/client/thinkspace-peer-assessment-pe/addon/components/assessment/item/quantitative.coffee"><meta name="groc-branch-path" content="feature/pe-documentation"><meta name="groc-github-url" content="https://github.com/sixthedge/cellar"><link rel="stylesheet" type="text/css" media="all" href="../../../../../../../assets/style.css"><script type="text/javascript" src="../../../../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/sixthedge/cellar/blob/feature/pe-documentation/src/thinkspace/client/thinkspace-peer-assessment-pe/addon/components/assessment/item/quantitative.coffee">src/thinkspace/client/thinkspace-peer-assessment-pe/addon/components/assessment/item/quantitative.coffee</a></div></div><div id="document"><a href="/" class="lodestar-link">Back to Guides</a><div class="segment"><div class="code"><div class="wrapper">import ember from <span class="hljs-string">'ember'</span>
import base_component from <span class="hljs-string">'thinkspace-base/components/base'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h1 id="quantitativecoffee">quantitative.coffee</h1>
<ul>
<li>Type: <strong>Component</strong></li>
<li>Package: <strong>thinkspace-peer-assessment-pe</strong></li>
</ul></div></div><div class="code"><div class="wrapper">export default base_component.extend</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="properties">Properties</h2>
<h3 id="internal-properties">Internal Properties</h3></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">manager</span>: <span class="hljs-literal">null</span> <span class="hljs-comment"># peer_assessment/evaluation</span>
  <span class="hljs-attribute">model</span>:   <span class="hljs-literal">null</span> <span class="hljs-comment"># item</span>
  <span class="hljs-attribute">comment</span>: <span class="hljs-literal">null</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="slider-properties">Slider properties</h4></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">slider</span>:
    <span class="hljs-attribute">classes</span>:
      <span class="hljs-attribute">fill</span>:   <span class="hljs-string">'ts-rangeslider_fill'</span>
      <span class="hljs-attribute">handle</span>: <span class="hljs-string">'ts-rangeslider_handle'</span>
      <span class="hljs-attribute">range</span>:  <span class="hljs-string">'ts-rangeslider'</span>
    <span class="hljs-attribute">colors</span>:
      <span class="hljs-attribute">fill</span>:
        <span class="hljs-string">'green'</span>:  <span class="hljs-string">'#6dc05e'</span>
        <span class="hljs-string">'yellow'</span>: <span class="hljs-string">'#fcb725'</span>
        <span class="hljs-string">'red'</span>:    <span class="hljs-string">'#fb6b6b'</span>
    <span class="hljs-attribute">templates</span>:
      <span class="hljs-attribute">ruler</span>: <span class="hljs-string">"&lt;div class='ts-rangeslider_ruler' /&gt;"</span>
      <span class="hljs-attribute">ticks</span>: <span class="hljs-string">"&lt;div class='ts-rangeslider_ticks' /&gt;"</span>
      <span class="hljs-attribute">background</span>: <span class="hljs-string">"&lt;div class='ts-rangeslider_background' /&gt;"</span>
    <span class="hljs-attribute">step</span>: <span class="hljs-number">1</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="computed-properties">Computed properties</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">review</span>:           ember.computed.reads <span class="hljs-string">'manager.review'</span>
  <span class="hljs-attribute">assessment</span>:       ember.computed.reads <span class="hljs-string">'manager.model'</span>
  <span class="hljs-attribute">points_different</span>: ember.computed.reads <span class="hljs-string">'assessment.points_different'</span>
  <span class="hljs-attribute">is_read_only</span>:     ember.computed.<span class="hljs-keyword">or</span> <span class="hljs-string">'manager.is_read_only'</span>, <span class="hljs-string">'manager.is_review_read_only'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="model-computed-properties">Model computed properties</h4>
<p>These come from the <code>model</code> which is a portion of the assessment&#39;s value JSON.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">points_min</span>: ember.computed <span class="hljs-string">'assessment.points_min'</span>, <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span>
    value = <span class="hljs-property">@get_model_property</span>(<span class="hljs-string">'settings.points.min'</span>)
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">if</span> ember.isPresent(value)  <span class="hljs-comment"># To catch the value of 0</span>
    value <span class="hljs-keyword">or</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.points_min'</span>)

  <span class="hljs-attribute">points_max</span>: ember.computed <span class="hljs-string">'assessment.points_max'</span>, <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span>
    value = <span class="hljs-property">@get_model_property</span>(<span class="hljs-string">'settings.points.max'</span>)
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">if</span> ember.isPresent(value)
    value <span class="hljs-keyword">or</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.points_max'</span>)

  <span class="hljs-attribute">points_descriptive_enabled</span>: ember.computed <span class="hljs-string">'assessment.points_descriptive_enabled'</span>, <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span>
    (<span class="hljs-property">@get</span>(<span class="hljs-string">'points_descriptive_low'</span>) <span class="hljs-keyword">and</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'points_descriptive_high'</span>)) <span class="hljs-keyword">or</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.points_descriptive_enabled'</span>)

  <span class="hljs-attribute">points_descriptive_low</span>: ember.computed <span class="hljs-string">'assessment.points_descriptive_low'</span>, <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@get_model_property</span>(<span class="hljs-string">'settings.labels.scale.min'</span>) <span class="hljs-keyword">or</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.points_descriptive_low'</span>)

  <span class="hljs-attribute">points_descriptive_high</span>: ember.computed <span class="hljs-string">'assessment.points_descriptive_high'</span>, <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@get_model_property</span>(<span class="hljs-string">'settings.labels.scale.max'</span>) <span class="hljs-keyword">or</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.points_descriptive_high'</span>)

  <span class="hljs-attribute">can_comment</span>:      ember.computed <span class="hljs-string">'model'</span>, <span class="hljs-function">-&gt;</span> <span class="hljs-property">@get_model_property</span>(<span class="hljs-string">'settings.comments.enabled'</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="observers">Observers</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">review_change</span>: ember.observer <span class="hljs-string">'review'</span>, <span class="hljs-function">-&gt;</span> <span class="hljs-property">@initialize_review</span>()

  <span class="hljs-attribute">fill_color_change</span>: ember.observer <span class="hljs-string">'fill_color'</span>, <span class="hljs-function">-&gt;</span>
    fill_color     = <span class="hljs-property">@get</span> <span class="hljs-string">'fill_color'</span>
    fill_class     = <span class="hljs-property">@get_slider_class</span> <span class="hljs-string">'fill'</span>
    fill_class_hex = <span class="hljs-property">@get</span> <span class="hljs-string">'fill_class_hex'</span>
    color          = <span class="hljs-property">@get_slider_color</span> fill_color
    <span class="hljs-property">@$</span>(<span class="hljs-string">".<span class="hljs-subst">#{fill_class}</span>"</span>).css(<span class="hljs-string">'background-color'</span>, color)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="events">Events</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">init</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@_super</span>()
    model_id      = <span class="hljs-property">@get</span>(<span class="hljs-string">'model.id'</span>)
    assessment_id = <span class="hljs-property">@get</span>(<span class="hljs-string">'assessment.id'</span>)
    ember.defineProperty @, <span class="hljs-string">'slider_value'</span>, ember.computed <span class="hljs-string">'review'</span>, <span class="hljs-string">"review.value.quantitative.<span class="hljs-subst">#{model_id}</span>.value"</span>, <span class="hljs-function">-&gt;</span>
      review = <span class="hljs-property">@get</span>(<span class="hljs-string">'review'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> ember.isPresent(review)
      value = review.get_quantitative_value_for_id(model_id)
      <span class="hljs-keyword">if</span> ember.isPresent(value) <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> value <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>  

  <span class="hljs-attribute">didInsertElement</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@$</span>(<span class="hljs-string">'input[type="range"]'</span>).rangeslider
        <span class="hljs-attribute">polyfill</span>:    <span class="hljs-literal">false</span>
        <span class="hljs-attribute">rangeClass</span>:  <span class="hljs-property">@get_slider_class</span>(<span class="hljs-string">'range'</span>)
        <span class="hljs-attribute">fillClass</span>:   <span class="hljs-property">@get_slider_class</span>(<span class="hljs-string">'fill'</span>)
        <span class="hljs-attribute">handleClass</span>: <span class="hljs-property">@get_slider_class</span>(<span class="hljs-string">'handle'</span>)
        <span class="hljs-attribute">onInit</span>: <span class="hljs-function">=&gt;</span> <span class="hljs-property">@slider_set_ruler</span>()
        <span class="hljs-attribute">onSlide</span>: <span class="hljs-function"><span class="hljs-params">(position, value)</span> =&gt;</span> <span class="hljs-property">@slider_set_color</span>(value); <span class="hljs-property">@slider_set_value</span>(value)
        <span class="hljs-attribute">onSlideEnd</span>: <span class="hljs-function">=&gt;</span> <span class="hljs-property">@manager_save_review</span>()
    <span class="hljs-keyword">if</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'points_descriptive_enabled'</span>)
      range_class = <span class="hljs-string">".<span class="hljs-subst">#{<span class="hljs-property">@get_slider_class</span>(<span class="hljs-string">'range'</span>)}</span>"</span>
      <span class="hljs-property">@$</span>(range_class).addClass(<span class="hljs-string">'is-descriptive'</span>) 
    <span class="hljs-property">@initialize_review</span>()

  <span class="hljs-attribute">willDestroyElement</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@$</span>(<span class="hljs-string">'input[type="range"]'</span>).rangeslider(<span class="hljs-string">'destroy'</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="helpers">Helpers</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">initialize_review</span>: <span class="hljs-function">-&gt;</span>
    value    = <span class="hljs-property">@get</span>(<span class="hljs-string">'slider_value'</span>)
    model_id = <span class="hljs-property">@get</span>(<span class="hljs-string">'model.id'</span>)
    comment  = <span class="hljs-property">@get</span>(<span class="hljs-string">'review'</span>).get_quantitative_comment_for_id(model_id)
    $slider  = <span class="hljs-property">@$</span>(<span class="hljs-string">'input[type="range"]'</span>)
    $slider.val(value).change()
    <span class="hljs-property">@set</span>(<span class="hljs-string">'comment'</span>, comment)
    ember.run.schedule <span class="hljs-string">'afterRender'</span>, <span class="hljs-function">=&gt;</span>
      $slider.rangeslider(<span class="hljs-string">'update'</span>) <span class="hljs-comment"># Disable any sliders that should be disabled.</span>

  <span class="hljs-attribute">get_model_property</span>: <span class="hljs-function"><span class="hljs-params">(path)</span> -&gt;</span>
    model = <span class="hljs-property">@get</span> <span class="hljs-string">'model'</span>
    model = ember.Object.create(model)
    model.get(path)

  <span class="hljs-attribute">manager_save_review</span>: <span class="hljs-function">-&gt;</span>  <span class="hljs-property">@get</span>(<span class="hljs-string">'manager'</span>).save_review()

  <span class="hljs-attribute">get_slider</span>: <span class="hljs-function"><span class="hljs-params">(prop)</span> -&gt;</span>
    slider = <span class="hljs-property">@get</span> <span class="hljs-string">'slider'</span>
    slider[prop]

  <span class="hljs-attribute">get_slider_class</span>: <span class="hljs-function"><span class="hljs-params">(prop)</span> -&gt;</span>
    classes = <span class="hljs-property">@get_slider</span> <span class="hljs-string">'classes'</span>
    classes[prop]

  <span class="hljs-attribute">get_slider_template</span>: <span class="hljs-function"><span class="hljs-params">(prop)</span> -&gt;</span>
    templates = <span class="hljs-property">@get_slider</span> <span class="hljs-string">'templates'</span>
    templates[prop]

  <span class="hljs-attribute">get_slider_color</span>: <span class="hljs-function"><span class="hljs-params">(prop)</span> -&gt;</span>
    colors = <span class="hljs-property">@get_slider</span> <span class="hljs-string">'colors'</span>
    colors.fill[prop]

  <span class="hljs-attribute">slider_set_ruler</span>: <span class="hljs-function">-&gt;</span>
    range_class = <span class="hljs-property">@get_slider_class</span> <span class="hljs-string">'range'</span>
    points_min  = <span class="hljs-property">@get</span> <span class="hljs-string">'points_min'</span>
    points_max  = <span class="hljs-property">@get</span> <span class="hljs-string">'points_max'</span>
    ruler       = <span class="hljs-string">''</span>
    ticks       = <span class="hljs-string">''</span>
    i           = points_min
    <span class="hljs-keyword">while</span> i    &lt;= points_max
      ruler += i + <span class="hljs-string">' '</span>
      ticks += <span class="hljs-string">'| '</span>
      i      = i + <span class="hljs-property">@get_slider</span> <span class="hljs-string">'step'</span>

    template    = <span class="hljs-property">@get_slider_template</span> <span class="hljs-string">'ruler'</span>
    $ruler      = $(template)
    template    = <span class="hljs-property">@get_slider_template</span> <span class="hljs-string">'ticks'</span>
    $ticks      = $(template)
    template    = <span class="hljs-property">@get_slider_template</span> <span class="hljs-string">'background'</span>
    $background = $(template)
    $ruler.html(ruler)
    $ticks.html(ticks)</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> TODO Come up with a more scalable way of handling the ruler, first, middle, last probably.</span></p></div></div><div class="code"><div class="wrapper">    <span class="hljs-comment">#} @$(".#{range_class}").prepend($ruler) unless @get('points_descriptive_enabled')</span>
    <span class="hljs-property">@$</span>(<span class="hljs-string">".<span class="hljs-subst">#{range_class}</span>"</span>).prepend($background)
    <span class="hljs-property">@$</span>(<span class="hljs-string">".<span class="hljs-subst">#{range_class}</span>"</span>).prepend($ticks)
    
  <span class="hljs-attribute">slider_set_value</span>: <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span> <span class="hljs-property">@get</span>(<span class="hljs-string">'manager'</span>).set_quantitative_value(<span class="hljs-property">@get</span>(<span class="hljs-string">'model.id'</span>), value)

  <span class="hljs-attribute">slider_set_color</span>: <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    points_max = <span class="hljs-property">@get</span> <span class="hljs-string">'points_max'</span>
    percentage = value / points_max
    <span class="hljs-keyword">switch</span> 
      <span class="hljs-keyword">when</span> percentage &gt;= <span class="hljs-number">0.67</span>
        <span class="hljs-property">@set</span> <span class="hljs-string">'fill_color'</span>, <span class="hljs-string">'green'</span>
      <span class="hljs-keyword">when</span> percentage &gt;= <span class="hljs-number">0.33</span> <span class="hljs-keyword">and</span> percentage &lt; <span class="hljs-number">0.67</span>
        <span class="hljs-property">@set</span> <span class="hljs-string">'fill_color'</span>, <span class="hljs-string">'yellow'</span>
      <span class="hljs-keyword">when</span> percentage &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> percentage &lt; <span class="hljs-number">0.33</span>
        <span class="hljs-property">@set</span> <span class="hljs-string">'fill_color'</span>, <span class="hljs-string">'red'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="actions">Actions</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-attribute">actions</span>:
    <span class="hljs-attribute">save_comment</span>: <span class="hljs-function">-&gt;</span> 
      manager = <span class="hljs-property">@get</span> <span class="hljs-string">'manager'</span>
      manager.set_quantitative_comment <span class="hljs-property">@get</span>(<span class="hljs-string">'model.id'</span>), <span class="hljs-property">@get</span>(<span class="hljs-string">'comment'</span>)</div></div></div></div></body></html>